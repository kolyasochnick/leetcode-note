# SOLUTION IDEA

# 1. У нас построено дерево, где каждый узел хранит значение дисбаланса
#    [
#    val = unique_even - unique_odd
#    ]

# 2. Если значение в корне равно нулю, то весь массив уже сбалансирован, и ответом является его полная длина.

# 3. Если корень не равен нулю, то необходимо «отсекать» элементы массива с одной стороны, чтобы приблизить итоговый дисбаланс к нулю.

# 4. При обходе дерева на каждом шаге выбирается направление (левое или правое поддерево), которое уменьшает абсолютное значение текущего дисбаланса.

# 5. Если дисбаланс узла можно уменьшить разными способами (то есть левая и правая ветви дают разные варианты), то каждая ветвь рассматривается отдельно как независимый случай.

# 6. Каждая выбранная ветвь обрабатывается рекурсивно по той же логике: продолжаем отбрасывать элементы только с одной стороны, пока не достигнем баланса или не станет ясно, что баланс невозможен.

# ---
# ##### Ограничение на направление отсечения

# 7. После того как на первом шаге выбрана сторона отсечения (например, мы начали убирать элементы слева), дальнейшие удаления могут происходить только с этой же стороны.

# 8. Если на некотором шаге оказывается, что несбалансированность «уходит» в противоположную сторону (то есть для исправления нужно удалять элементы справа), то текущий узел считается полностью непригодным — приходится отбрасывать весь рассматриваемый сегмент целиком.

# ---

# ##### Учёт сбалансированных частей

# 9. Если правая часть (или оставшаяся часть, которую мы не удаляем) уже имеет значение `0`, то она считается валидной и должна быть добавлена в ответ.

# 10. Если узел распадается на два подузла, оба из которых несбалансированы, то такой узел не даёт полезного результата и не должен учитываться в подсчёте.

# 11. Если узел содержит только одного потомка (только левый или только правый), то он просто передаёт его значение вверх без изменений.

# ---


# 12. Ответ формируется как суммарный подсчёт всех подходящих подветвей, которые могут быть приведены к балансу путём удаления элементов только с одной стороны.

# ---


